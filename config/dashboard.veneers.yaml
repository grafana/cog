builders:
  ##############
  # Dashboards #
  ##############

  # We don't want these builders at all
  - omit: { by_object: Dashboard.GridPos }
  - omit: { by_object: Dashboard.DataSourceRef }
  - omit: { by_object: Dashboard.LibraryPanelRef }

  # Rearrange things a bit
  - merge_into:
      source: Dashboard.FieldConfig
      destination: Dashboard.Panel
      under_path: fieldConfig.defaults
      exclude_options: [
        # don't copy these over as they clash with a similarly named options from Panel
        "description", "links",

        # TODO: check if these are actually relevant
        "displayNameFromDS", "filterable", "path", "writeable",
      ]

  # Panels composability
  - compose_dashboard_panel:
      panel_builder_name: Dashboard.Panel
      exclude_panel_options: [
        "id",            # generated by the backend
        "fieldConfig",   # merged with another builder
        "options",       # comes from a panel plugin
        "custom",        # comes from a panel plugin
        "pluginVersion", # TODO: check if it's relevant or not
        "repeatPanelId", # TODO: check if it's relevant or not
        "tags",          # TODO: check if it's relevant or not
      ]

  # remove builders that were previously merged into something else
  - omit: { by_object: Dashboard.FieldConfig }
  - omit: { by_object: Dashboard.FieldConfigSource }

  # No need for builders for structs generated from a disjunction
  - omit: { generated_from_disjunction: true }

options:
  ##############
  # Dashboards #
  ##############

  # Make the dashboard constructor more friendly
  - promote_to_constructor: { by_name: Dashboard.title }

  # `Tooltip` looks better than `GraphTooltip`
  - rename:
      by_name: Dashboard.graphTooltip
      as: tooltip

  # `Tooltip` looks better than `GraphTooltip`
  - rename:
      by_name: Dashboard.graphTooltip
      as: tooltip

  # Editable() + Readonly() instead of Editable(val bool)
  - unfold_boolean:
      by_name: Dashboard.editable
      true_as: editable
      false_as: readonly

  # Refresh(string) instead of Refresh(struct StringOrBool)
  - struct_fields_as_arguments:
      by_name: dashboard.refresh
      fields: [ValString]

  # We don't want these options at all
  - omit: { by_name: Dashboard.schemaVersion }

  ##############
  #   Panels   #
  ##############

  - omit: { by_name: Panel.id }            # generated by the backend
  - omit: { by_name: Panel.fieldConfig }   # merged with another builder
  - omit: { by_name: Panel.pluginVersion } # TODO: check if it's relevant or not
  - omit: { by_name: Panel.repeatPanelId } # TODO: check if it's relevant or not
  - omit: { by_name: Panel.tags }          # TODO: check if it's relevant or not
